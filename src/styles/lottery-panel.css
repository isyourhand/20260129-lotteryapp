/* src/styles/lottery-panel.css */
/* 3D 抽奖球面板样式 */
/* 
 * CSS 变量说明（由 JS 动态设置）：
 * --card-anim-total: 单张卡片动画总时长（默认 3.5s）
 * --card-anim-fly-to-center: 飞到中央时间（默认 0.5s）
 * --card-anim-show-in-center: 中央展示时间（默认 2s）
 * --card-anim-fly-to-grid: 飞到网格时间（默认 1s）
 * --lottery-card-interval: 卡片间隔（默认 3.5s）
 */

/* 3D 舞台区域 */
.canvas-area {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  perspective: 1500px;
  z-index: 10;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
}

/* 球体缩放包装层 - 用于鼠标滚轮缩放 */
.sphere-scale-wrapper {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  transform-origin: center center;
  transition: transform 0.1s ease-out;
}

/* 球体容器 */
.sphere-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 0;
  height: 0;
  transform-style: preserve-3d;
}

/* 抽奖卡片样式 */
.lottery-card {
  position: absolute;
  width: 90px;
  height: 50px;
  background: rgba(185, 43, 116, 0.35);
  border: 1px solid rgba(255, 154, 158, 0.5);
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  backface-visibility: visible;
  box-shadow: 0 0 15px rgba(185, 43, 116, 0.4);
  left: -50px;
  top: -30px;
  text-shadow: 0 0 2px black;
  transition:
    transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275),
    box-shadow 0.8s ease,
    z-index 0s 0s;
  will-change: transform, opacity;
}

.lottery-card .card-name {
  font-weight: bold;
  font-size: 1.2rem;
  white-space: nowrap;
}

.lottery-card .card-dept {
  font-size: 0.7rem;
  opacity: 0.8;
}

/* 中奖态：卡片飞出 */
.lottery-card.revealing-winner {
  border: 2px solid transparent;
  background:
    linear-gradient(
        135deg,
        rgba(185, 43, 116, 0.95) 0%,
        rgba(90, 26, 74, 0.95) 100%
      )
      padding-box,
    linear-gradient(90deg, #ffd700, #ffed4a, #ffd700, #ffaa00, #ffd700)
      border-box;
  background-size:
    200% 100%,
    300% 100%;
  box-shadow:
    0 0 50px rgba(255, 215, 0, 0.8),
    inset 0 0 20px rgba(255, 215, 0, 0.5);
  z-index: 9999 !important;
  animation:
    winnerPulse 0.6s ease-in-out infinite alternate,
    borderGlow 2s linear infinite;
}

/* 一等奖球体中奖卡片 - 红色流动光芒 */
.lottery-card.revealing-winner.first-prize {
  background:
    linear-gradient(135deg, #8b0000 0%, #4a0000 100%) padding-box,
    linear-gradient(90deg, #ff0000, #ff6b6b, #ff0000, #ff4444, #ff0000)
      border-box !important;
  background-size:
    200% 100%,
    300% 100% !important;
  box-shadow:
    0 0 50px rgba(255, 0, 0, 0.8),
    inset 0 0 20px rgba(255, 0, 0, 0.5) !important;
  animation:
    redPulse 0.6s ease-in-out infinite alternate,
    redBorderFlow 2s linear infinite !important;
}

/* 中奖卡片脉冲动画 */
@keyframes winnerPulse {
  0% {
    box-shadow:
      0 0 50px rgba(255, 215, 0, 0.8),
      inset 0 0 20px rgba(255, 215, 0, 0.5);
  }
  100% {
    box-shadow:
      0 0 70px rgba(255, 215, 0, 1),
      inset 0 0 30px rgba(255, 215, 0, 0.8);
  }
}

/* 金色边框发光动画 */
@keyframes borderGlow {
  0% {
    background-position:
      0% 50%,
      0% 50%;
  }
  100% {
    background-position:
      0% 50%,
      300% 50%;
  }
}

/* 红色边框流动动画 */
@keyframes redBorderFlow {
  0% {
    background-position:
      0% 50%,
      0% 50%;
  }
  100% {
    background-position:
      0% 50%,
      300% 50%;
  }
}

/* =========================================
   中奖展示层 - 全屏定位层
   ========================================= */
.winner-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 200;
  /* 注意：不能设置 overflow: hidden，否则卡片飞入过程中会被裁剪 */
}

/* =========================================
   三阶段动画：球体 -> 屏幕中央展示 -> 右侧网格
   注意：@keyframes flyFromSphereToGrid 由 JS 动态注入
   定义在 src/hooks/useAnimationConfig.ts
   ========================================= */

/* =========================================
   中奖卡片 - 绝对定位飞行
   ========================================= */
.winner-card-static {
  /* 使用绝对定位，可以在全屏范围内飞行 */
  position: absolute;
  width: 110px;
  height: 80px;
  background: rgba(119, 77, 99, 0.95);
  border: 2px solid rgba(255, 215, 0, 0.8);
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  pointer-events: auto;
  /* 初始透明，动画会设置为可见 */
  opacity: 0;
  /* 金色流动边框效果 */
  background-image:
    linear-gradient(
      135deg,
      rgba(185, 43, 116, 0.95) 0%,
      rgba(90, 26, 74, 0.95) 100%
    ),
    linear-gradient(90deg, #ffd700, #ffed4a, #ffd700, #ffaa00, #ffd700);
  background-origin: border-box;
  background-clip: padding-box, border-box;
  background-size:
    200% 100%,
    300% 100%;
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
  /* 动画时长由 JS 动态设置，见 useAnimationConfig.ts */
  animation:
    flyFromSphereToGrid var(--card-anim-total) cubic-bezier(0.34, 1.56, 0.64, 1)
      forwards,
    goldBorderFlow 2s linear infinite;
  will-change: transform, opacity;
  transform-origin: center center;
  /* 使用 left/top 定位到目标网格位置 - 提供默认值防止未定义 */
  left: var(--target-x, 85vw);
  top: var(--target-y, 50vh);
  margin-left: -55px;
  margin-top: -40px;
  z-index: 201;
}

/* 金色边框流动动画 */
@keyframes goldBorderFlow {
  0% {
    background-position:
      0% 50%,
      0% 50%;
  }
  100% {
    background-position:
      0% 50%,
      300% 50%;
  }
}

.winner-card-static .card-name {
  font-size: 1.1rem;
  font-weight: bold;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 90%;
}

.winner-card-static .card-dept {
  font-size: 0.7rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 90%;
  opacity: 0.9;
}

.winner-card-static .card-prize-detail {
  margin-top: 4px;
  font-size: 0.75rem;
  color: #ffd700;
  font-weight: bold;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 90%;
  border-top: 1px dashed rgba(255, 215, 0, 0.3);
  padding-top: 4px;
}

/* =========================================
   一等奖飞出卡片特效 - 红色流动光芒
   ========================================= */
.winner-card-static.first-prize {
  background:
    linear-gradient(135deg, #8b0000 0%, #4a0000 100%) padding-box,
    linear-gradient(90deg, #ff0000, #ff6b6b, #ff0000, #ff4444, #ff0000)
      border-box !important;
  background-size:
    200% 100%,
    300% 100% !important;
  border: 2px solid transparent !important;
  box-shadow:
    0 0 30px rgba(255, 0, 0, 0.8),
    0 0 60px rgba(255, 0, 0, 0.5) !important;
  animation:
    flyFromSphereToGrid var(--card-anim-total, 3.5s)
      cubic-bezier(0.34, 1.56, 0.64, 1) forwards,
    redBorderFlow 2s linear infinite,
    redPulse 1.5s ease-in-out infinite alternate !important;
}

@keyframes redPulse {
  0% {
    box-shadow:
      0 0 30px rgba(255, 0, 0, 0.8),
      0 0 60px rgba(255, 0, 0, 0.5);
  }
  100% {
    box-shadow:
      0 0 40px rgba(255, 0, 0, 1),
      0 0 80px rgba(255, 0, 0, 0.7),
      0 0 120px rgba(255, 0, 0, 0.4);
  }
}

/* 一等奖卡片文字样式 */
.winner-card-static.first-prize .card-name {
  color: #fff;
  text-shadow:
    0 0 10px rgba(255, 0, 0, 0.8),
    0 0 20px rgba(255, 0, 0, 0.5);
}

.winner-card-static.first-prize .card-dept {
  color: rgba(255, 200, 200, 0.9);
}

.winner-card-static.first-prize .card-prize-detail {
  color: #ffcccc;
  border-top: 1px dashed rgba(255, 100, 100, 0.5);
}

/* 响应式：小屏幕时调整卡片大小 */
@media (max-width: 1400px) {
  .winner-card-static {
    width: 100px;
    height: 70px;
    margin-left: -50px;
    margin-top: -35px;
  }
}
